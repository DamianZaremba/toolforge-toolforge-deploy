environments:
  local:
    values:
      # needed to use the chartVersion
      - values/common.yaml*
      - values/{{ .Environment.Name }}.yaml*
  tools:
    values:
      # needed to use the chartVersion
      - values/common.yaml*
      - values/{{ .Environment.Name }}.yaml*
  toolsbeta:
    values:
      # needed to use the chartVersion
      - values/common.yaml*
      - values/{{ .Environment.Name }}.yaml*
---
repositories:
  - name: grafana
    url: https://grafana.github.io/helm-charts

releases:
  - name: infra-tracing-loki-secret
    chart: wmf-stable/raw
    version: 0.3.0
    namespace: infra-tracing-loki
    values:
      - resources:
          - apiVersion: v1
            kind: Secret
            metadata:
              name: infra-tracing-loki-basic-auth
            type: Opaque
            stringData:
              .htpasswd: "{{ .Values.infraTracingLoki.htpasswd | trim }}"
  - name: infra-tracing-loki
    namespace: infra-tracing-loki
    createNamespace: true
    chart: grafana/loki
    version: "{{ .Values.loki.chartVersion }}"
    values:
      - ../common/values/loki/common.yaml*
      - ../common/values/loki/{{ .Environment.Name }}.yaml*
      - values/common.yaml*
      - values/{{ .Environment.Name }}.yaml*
