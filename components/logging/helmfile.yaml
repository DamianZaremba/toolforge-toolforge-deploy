environments:
  local:
    values:
      # needed to use the chartVersion
      - values/common.yaml*
      - values/{{ .Environment.Name }}.yaml*
  tools:
    values:
      # needed to use the chartVersion
      - values/common.yaml*
      - values/{{ .Environment.Name }}.yaml*
  toolsbeta:
    values:
      # needed to use the chartVersion
      - values/common.yaml*
      - values/{{ .Environment.Name }}.yaml*
---
repositories:
  - name: grafana
    url: https://grafana.github.io/helm-charts

releases:
  # Instance for storing tool logs.
  - name: loki-tools
    namespace: loki
    createNamespace: true
    chart: grafana/loki
    version: "{{ .Values.loki.chartVersion }}"
    values:
      - values/loki/common.yaml*
      - values/loki/{{ .Environment.Name }}.yaml*
      - values/loki-tools/common.yaml*
      - values/loki-tools/{{ .Environment.Name }}.yaml*
  # Instance for storing tools interdependency tracing logs
  - name: loki-tracing
    namespace: loki-tracing
    createNamespace: true
    chart: grafana/loki
    version: "{{ .Values.loki.chartVersion }}"
    values:
      - values/loki/common.yaml*
      - values/loki/{{ .Environment.Name }}.yaml*
      - values/loki-tracing/{{ .Environment.Name }}.yaml*
      - values/loki-tracing/common.yaml*
  - name: alloy
    # This needs a separate namespace for network policy reasons.
    namespace: alloy
    createNamespace: true
    chart: grafana/alloy
    version: "{{ .Values.alloy.chartVersion }}"
    values:
      - values/alloy/common.yaml*
      - values/alloy/{{ .Environment.Name }}.yaml*
